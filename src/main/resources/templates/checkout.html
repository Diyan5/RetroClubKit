<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/background.css}">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th, td {
            padding: 10px;
            text-align: center;
        }
        .total {
            font-size: 1.5rem;
            text-align: right;
            margin-top: 10px;
            margin-bottom: 20px;
        }
        button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        form {
            margin-top: 20px;
        }
        form input, form select {
            padding: 10px;
            margin: 5px 0;
            width: 100%;
            max-width: 400px;
            display: block;
        }
        form button {
            margin-top: 10px;
        }
    </style>
</head>
<body>
<h1>Checkout</h1>
<table>
    <thead>
    <tr>
        <th>Image</th>
        <th>Product Name</th>
        <th>Size</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Total</th>
    </tr>
    </thead>
    <tbody id="cartItems">
    <!-- Продуктите ще бъдат добавени тук -->
    </tbody>
</table>
<div class="total" id="grandTotal">Total: $0</div>
<button id="clearCart">Clear Cart</button>

<h2>Delivery Information</h2>
<form id="deliveryForm">
    <label for="name">Full Name:</label>
    <input type="text" id="name" name="name" placeholder="Enter your full name" required>

    <label for="country">Country:</label>
    <input type="text" id="country" name="country" placeholder="Enter your country" required>

    <label for="address">Address:</label>
    <input type="text" id="address" name="address" placeholder="Enter your address" required>

    <label for="city">City:</label>
    <input type="text" id="city" name="city" placeholder="Enter your city" required>

    <label for="phone">Phone Number:</label>
    <input type="text" id="phone" name="phone" placeholder="Enter your phone number" required>

    <button type="submit">Submit Order</button>
</form>

<script>
    // Взимане на количката от LocalStorage
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const cartItemsContainer = document.getElementById('cartItems');
    const grandTotalElement = document.getElementById('grandTotal');
    let grandTotal = 0;

    // Показване на продуктите в таблицата
    cart.forEach(product => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td><img src="${product.img}" alt="${product.name}" style="width: 50px;"></td>
            <td>${product.name}</td>
            <td>${product.size}</td>
            <td>$${product.price}</td>
            <td>${product.quantity}</td>
            <td>$${(product.price * product.quantity).toFixed(2)}</td>
        `;
        cartItemsContainer.appendChild(row);
        grandTotal += product.price * product.quantity;
    });

    // Обновяване на общата сума
    grandTotalElement.textContent = `Total: $${grandTotal.toFixed(2)}`;

    // Обработчик за "Изчисти количката"
    document.getElementById('clearCart').addEventListener('click', () => {
        // Изчистване на количката от LocalStorage
        localStorage.removeItem('cart');

        // Обновяване на брояча на количката (ако има такъв в DOM)
        const cartCount = document.querySelector('.cart-count');
        if (cartCount) {
            cartCount.textContent = 0; // Задаваме брояча на 0
        }

        // Изпращане на събитие, за да информираме всички страници, че количката е изчистена
        localStorage.setItem('cartUpdated', Date.now()); // Добавяне на времеви маркер за синхронизация

        // Презареждане на текущата страница (опционално)
        window.location.reload();
    });
</script>

</body>
</html>
