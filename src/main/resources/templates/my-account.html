<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Account</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/background.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/home.css}">
</head>
<body>

<header>
    <a th:href="@{/home}" class="logo">
        <img th:src="@{/images/th.png}" alt="Retro Football Logo" style="height: 48px;">
        Retro Football Shirts
    </a>
    <div class="nav">
        <ul>
            <li><a th:href="@{/home}">Home</a></li>
            <li><a th:href="@{/my-account}">My Account</a></li>
            <li><a th:href="@{/contact}">Contact</a></li>
        </ul>
        <a th:href="@{/logout}" class="exit">Logout</a>
    </div>
</header>

<main>
    <h1>My Account</h1>

    <section id="user-info">
        <h2>Profile Information</h2>
        <p><strong>Username:</strong> <span th:text="${user.username}"></span></p>

        <!-- üîπ –ü–æ–ª–µ—Ç–∞—Ç–∞ —â–µ –±—ä–¥–∞—Ç –∑–∞–º–µ–Ω–µ–Ω–∏ —Å input –ø–æ–ª–µ—Ç–∞ –ø—Ä–∏ Edit Mode -->
        <p><strong>First name:</strong> <span id="firstNameDisplay" th:text="${user.firstName}"></span>
            <input type="text" id="firstNameInput" th:value="${user.firstName}" style="display: none;">
        </p>

        <p><strong>Last name:</strong> <span id="lastNameDisplay" th:text="${user.lastName}"></span>
            <input type="text" id="lastNameInput" th:value="${user.lastName}" style="display: none;">
        </p>

        <p><strong>Email:</strong> <span id="emailDisplay" th:text="${user.email}"></span>
            <input type="text" id="emailInput" th:value="${user.email}" style="display: none;">
        </p>

        <!-- üîπ –ë—É—Ç–æ–Ω –∑–∞ —Ä–µ–¥–∞–∫—Ü–∏—è -->
        <button id="editProfile">Edit Profile</button>
        <button id="saveChanges" style="display: none;">Save Changes</button>
    </section>

    <section id="orders-button">
        <a th:href="@{/orders}" class="btn">My Orders</a>
    </section>
</main>

<script>
    document.getElementById("editProfile").addEventListener("click", function() {
        // –°–∫—Ä–∏–≤–∞–º–µ —Å—Ç–∞—Ä–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –∏ –ø–æ–∫–∞–∑–≤–∞–º–µ input –ø–æ–ª–µ—Ç–∞—Ç–∞
        document.getElementById("firstNameDisplay").style.display = "none";
        document.getElementById("lastNameDisplay").style.display = "none";
        document.getElementById("emailDisplay").style.display = "none";

        document.getElementById("firstNameInput").style.display = "inline-block";
        document.getElementById("lastNameInput").style.display = "inline-block";
        document.getElementById("emailInput").style.display = "inline-block";

        // –ü–æ–∫–∞–∑–≤–∞–º–µ –±—É—Ç–æ–Ω–∞ "Save Changes"
        document.getElementById("saveChanges").style.display = "inline-block";
        this.style.display = "none"; // –°–∫—Ä–∏–≤–∞–º–µ "Edit Profile"
    });

    document.getElementById("saveChanges").addEventListener("click", async function() {
        const firstName = document.getElementById("firstNameInput").value;
        const lastName = document.getElementById("lastNameInput").value;
        const email = document.getElementById("emailInput").value;

        const response = await fetch("/my-account", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ firstName, lastName, email })
        });

        if (response.ok) {
            alert("Profile updated successfully!");
            location.reload(); // –ü—Ä–µ–∑–∞—Ä–µ–∂–¥–∞–º–µ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞, –∑–∞ –¥–∞ –ø–æ–∫–∞–∂–µ–º –Ω–æ–≤–∏—Ç–µ –¥–∞–Ω–Ω–∏
        } else {
            alert("Failed to update profile.");
        }
    });
</script>

</body>
</html>
